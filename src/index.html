<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Aggregator</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f5;
            color: #333;
        }
        .container {
            max-width: 100%;
            padding: 15px;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .premium-card {
            border: 2px solid #fbbf24;
            background-color: #fffbeb;
        }
        .btn {
            display: inline-block;
            padding: 8px 16px;
            background: #3b82f6;
            color: white;
            border-radius: 8px;
            text-decoration: none;
            text-align: center;
            margin-top: 10px;
        }
        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #e5e7eb;
        }
        .tab {
            padding: 10px 15px;
            cursor: pointer;
        }
        .tab.active {
            border-bottom: 2px solid #3b82f6;
            color: #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>Telegram Aggregator</h2>
            <p>–ù–∞–π–¥–∏—Ç–µ –ª—É—á—à–∏–µ –∫–∞–Ω–∞–ª—ã, –±–æ—Ç—ã –∏ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('channels')">–ö–∞–Ω–∞–ª—ã</div>
            <div class="tab" onclick="showTab('bots')">–ë–æ—Ç—ã</div>
            <div class="tab" onclick="showTab('apps')">–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
        </div>

        <div id="channels-tab" class="tab-content">
            <div class="card premium-card">
                <h3>üåü –ü—Ä–µ–º–∏—É–º –∫–∞–Ω–∞–ª</h3>
                <p>–¢–µ–º–∞—Ç–∏–∫–∞: –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</p>
                <p>–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: 25K</p>
                <a href="https://t.me/premium_channel" class="btn">–ü–µ—Ä–µ–π—Ç–∏</a>
            </div>
            
            <div class="card">
                <h3>–ö–∞–Ω–∞–ª –ø—Ä–æ IT</h3>
                <p>–¢–µ–º–∞—Ç–∏–∫–∞: –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
                <p>–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: 10K</p>
                <a href="https://t.me/it_channel" class="btn">–ü–µ—Ä–µ–π—Ç–∏</a>
            </div>
        </div>

        <div id="bots-tab" class="tab-content" style="display:none;">
            <div class="card premium-card">
                <h3>üåü –ü—Ä–µ–º–∏—É–º –±–æ—Ç</h3>
                <p>–¢–µ–º–∞—Ç–∏–∫–∞: –§–∏–Ω–∞–Ω—Å—ã</p>
                <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 50K</p>
                <a href="https://t.me/premium_bot" class="btn">–ü–µ—Ä–µ–π—Ç–∏</a>
            </div>
            
            <div class="card">
                <h3>–ë–æ—Ç-–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫</h3>
                <p>–¢–µ–º–∞—Ç–∏–∫–∞: –Ø–∑—ã–∫–∏</p>
                <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 15K</p>
                <a href="https://t.me/translate_bot" class="btn">–ü–µ—Ä–µ–π—Ç–∏</a>
            </div>
        </div>

        <div id="apps-tab" class="tab-content" style="display:none;">
            <div class="card">
                <h3>–ò–≥—Ä–∞-–≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞</h3>
                <p>–†–µ–π—Ç–∏–Ω–≥: ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</p>
                <a href="https://t.me/game_mini_app" class="btn">–û—Ç–∫—Ä—ã—Ç—å</a>
            </div>
        </div>
    </div>

    <script>
        async function loadProjects(type) {
            try {
                const response = await fetch(`http://your-server-address:8000/projects/?type=${type}`);
                const projects = await response.json();

                const tabContent = document.getElementById(`${type}-tab`);
                tabContent.innerHTML = '';

                projects.forEach(project => {
                    const card = document.createElement('div');
                    card.className = `card ${project.is_premium ? 'premium-card' : ''}`;
                    card.innerHTML = `
                        <h3>${project.is_premium ? 'üåü ' : ''}${project.name}</h3>
                        <p>–¢–µ–º–∞—Ç–∏–∫–∞: ${project.theme}</p>
                        ${project.subscribers ? `<p>–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: ${project.subscribers.toLocaleString()}</p>` : ''}
                        <a href="${project.link}" class="btn">–ü–µ—Ä–µ–π—Ç–∏</a>
                        ${project.likes ? `<span>‚ù§Ô∏è ${project.likes}</span>` : ''}
                    `;
                    tabContent.appendChild(card);
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤:', error);
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é showTab
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });

            const activeTab = document.getElementById(`${tabName}-tab`);
            activeTab.style.display = 'block';
            loadProjects(tabName);

            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function initUser() {
            const user = tg.initDataUnsafe?.user;
            if (user) {
                const response = await fetch(`http://your-server-address:8000/users/${user.id}`);
                const userData = await response.json();

                tg.MainButton.setText(`–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å (${userData.stars}‚òÖ)`);
                tg.MainButton.show();
                tg.MainButton.onClick(() => {
                    tg.showAlert(`–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å: ${userData.stars}‚òÖ, ${userData.balance} —Ä—É–±.`);
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        initUser();
        showTab('channels');
    </script>
</body>
</html>